{% extends "waterlevel/waterlevel.html" %}

{% load i18n verbose_names waterlevel_tags common_tags common_filters %}

{% block title %}{{ block.super }} - {% trans "Water Gates" %}{% endblock %}


{% block extra_css %}
<style type="text/css">
.SIAGA-1 {
    background-color: #ff6666;
}

.SIAGA-2 {
    background-color: #ffcc00;
}

.SIAGA-3 {
    background-color: #ffff66;
}

.SIAGA-4 {
    background-color: #91ff66;
}

.floatedTable {
    float:left;
}

.inlineTable {
    display: inline-block;
}

table, th{
    border: 1px solid black;
    border-collapse: collapse;
    text-align: center;
}

table.table1, table.table1 tr, table.table1 td {
    border: 10px ;
    border-collapse: collapse;
    text-align: right;
    
    border-spacing: 5px;
    padding: 0px;
}

.pull-left {
  float: left !important;
}
</style>
{% endblock extra_css %}

{% block page_content %}

<div class="col-xs-6">
    <div class="table-responsive">
    <table  class="table table-striped table-bordered">
    <thead>
        <tr>
            {% for watergate in watergate_list|slice:'1' %}
            <th rowspan="2" >{% get_verbose_field_name watergate 'name' %}</th>
            <th colspan="5" >BATAS SIAGA</th>
        </tr>
        <tr>
            <th class="SIAGA-1">SIAGA 1</th>
            <th class="SIAGA-2">SIAGA 2</th>
            <th class="SIAGA-3">SIAGA 3</th>
          </tr>
            {% endfor %}
    </thead>
    
    <tbody>
        <tr>
            {% for watergate in watergate_list %}
            <td align="left"><a href="{{ watergate.get_absolute_url }}">{{ watergate.name }}</a></td>
            <td class="SIAGA-1" align="center"> â‰¥{{ watergate.siaga_1_min }}</td>
            <td class="SIAGA-2" align="center">{{ watergate.siaga_2_min }} ~ {{ watergate.siaga_2_max }}</td>
            <td class="SIAGA-3" align="center">{{ watergate.siaga_3_min }} ~ {{ watergate.siaga_3_max }}</td>
        </tr>
            {% empty %}
        <tr>
           <td colspan="6" class="text-center">{% trans "No water gates found." %}</td>
        </tr>
            {% endfor %}
    </tbody>
    </table>
    </div>
</div>

    <div class="table-responsive">
    <table class="table table-striped table-bordered">
    <thead>
       <tr>
            <th colspan="24" class="text-center">WAKTU</th>
       </tr>
       <tr>
            {% for i in now.hour|add:"1"|loop %}
            <th class="text-center">{% if forloop.counter0 < 10 %}0{% endif %}{{ forloop.counter0 }}:00</th>
            {% endfor %}
        </tr>
    </thead>
    
    <tbody>
    <tr>
        {% for watergate in watergate_list %}
            {% get_waterlevelreport watergate now as waterlevelreports %}
                {% for waterlevelreport in waterlevelreports %}
                    <td class="text-center {{ waterlevelreport.get_threshold_level }}">{% if forloop.counter0 = waterlevelreport.created|date:"H"|add:"0" %} {{ waterlevelreport.height }}{{ waterlevelreport.weather }}{% else %}-{% endif %}</td>
                {% endfor %}

            {% if waterlevelreports.count < now.hour|add:"1" %}
                {% subtract now.hour|add:"1" waterlevelreports.count as diff  %}
                    {% for i in diff|loop %}
                     <td class="text-center">-</td>
                    {% endfor %}
            {% endif %}
     </tr>
        {% endfor  %}
    </tbody>
    </table>
</div>


<div class="pull-left"><table  class="table1" width="500" cellspacing="0" cellpadding="4" >
        <tr>
            <td align="right" ><strong>Siaga I</strong></td>
            <td>&nbsp;&nbsp;</td>
            <td class="SIAGA-1">&nbsp;&nbsp;</td><td>Bencana</td>
            <td align="right"><strong>Siaga II</strong></td>
            <td>&nbsp;&nbsp;</td>
            <td class="SIAGA-2">&nbsp;&nbsp;</td><td>Kritis</td>
            <td align="right"><strong>Siaga III</strong></td>
            <td>&nbsp;&nbsp;</td>
            <td class="SIAGA-3">&nbsp;&nbsp;</td><td>Waspada</td>
            <td align="right"><strong>Siaga IV</strong></td>
            <td>&nbsp;&nbsp;</td>
            <td class="SIAGA-4">&nbsp;&nbsp;</td><td>Aman</td>
        </tr>
    </table>
	<table class="table1" width="500" cellspacing="0" cellpadding="4">
        <tr>
            <td align="left"><strong>T: </strong>Terang</td>
            <td>&nbsp;</td>
            <td align="left"><strong>MT: </strong>Mendung Tipis</td>
            <td>&nbsp;</td>
            <td align="left"><strong>M: </strong>Mendung</td>
            <td>&nbsp;</td>
            <td align="left"><strong>G: </strong>Gerimis</td>
            <td>&nbsp;</td>
            <td align="left"><strong>H: </strong>Hujan</td>
        </tr>
    </table>

<head>
{% block extra_js_lib  %}
  <!-- Plotly.js -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
{% endblock %}
</head>


<body>

  <div id="chart" style="width: 1100px; height: 400px;">
  <script>
   {% for watergate in watergate_list %}
      {% get_waterlevelreport watergate now as waterlevelreports %}
        var waterlevel_{{ watergate.pk }}= [{% for waterlevelreport in waterlevelreports %}{% if forloop.counter0 = waterlevelreport.created|date:"H"|add:"0" %}{{ waterlevelreport.height }},{% endif %}{% endfor %}{% if waterlevelreports.count < now.hour|add:"1" %}{% subtract now.hour|add:"1" waterlevelreports.count as diff  %}{% for i in diff|loop %}'',{% endfor %}{% endif %}]
        var times = [{% for i in now.hour|add:"1"|loop %}'{% if forloop.counter0 < 10 %}0{% endif %}{{ forloop.counter0 }}:00',{% endfor %}]          
            
    var trace_{{ watergate.pk }} = {
                                    y: waterlevel_{{ watergate.pk }},
                                    x: times,
                                    mode: 'lines+markers',
                                    name: '{{ watergate.name }}'
                                   };
 {% endfor %}
  var data = [ {% for watergate in watergate_list %}trace_{{ watergate.pk }},{% endfor %}];  
  var layout = {
                title: 'Grafik Tinggi Muka Air',
                xaxis: {
                        title: 'WAKTU'
                       },
                yaxis: {
                        title: 'KETINGGIAN (cm)'
                       }
                };
Plotly.newPlot('chart', data, layout);

 </script>
 </div>
</body>


{% comment %}
{% endcomment %}

{% include 'opendims/includes/pagination.html' with page=page_obj %}
{% endblock %}  